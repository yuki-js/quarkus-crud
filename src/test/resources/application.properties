# Test Database Configuration
# Dev Services automatically starts PostgreSQL container for local testing
quarkus.datasource.db-kind=postgresql

# HTTP Configuration for tests
# Use port 0 to let the OS assign a random available port for parallel test execution
quarkus.http.test-port=0

# Enable Dev Services for tests (automatic PostgreSQL container)
quarkus.datasource.devservices.enabled=true
quarkus.datasource.devservices.image-name=postgres:15-alpine

# Default credentials (used by Dev Services and CI)
quarkus.datasource.username=postgres
quarkus.datasource.password=postgres

# NOTE: No JDBC URL specified here - Dev Services will provide it automatically
# In CI, set QUARKUS_DATASOURCE_JDBC_URL environment variable to override Dev Services:
#   export QUARKUS_DATASOURCE_JDBC_URL=jdbc:postgresql://localhost:5432/quarkus_crud

# Flyway Configuration
quarkus.flyway.clean-at-start=true
quarkus.flyway.migrate-at-start=true
quarkus.flyway.locations=classpath:db/migration

# MyBatis Configuration
mybatis.environment.id=quarkus

# JWT Configuration for tests
mp.jwt.verify.publickey.location=classpath:dev-keys/publicKey.pem
mp.jwt.verify.issuer=https://quarkus-crud.ouchiserver.aokiapp.com
mp.jwt.verify.publickey.algorithm=ES256
smallrye.jwt.sign.key.location=classpath:dev-keys/privateKey.pem
smallrye.jwt.new-token.issuer=https://quarkus-crud.ouchiserver.aokiapp.com
# Token lifespan configuration by authentication method
# Anonymous users: 365 days (31536000 seconds) - longer since they cannot re-authenticate
smallrye.jwt.new-token.lifespan.anonymous=31536000
# OIDC users: 1 hour (3600 seconds) - follows OAuth2 best practices for short-lived tokens
smallrye.jwt.new-token.lifespan.oidc=3600

# CORS Configuration for tests (matches production configuration)
quarkus.http.cors.enabled=true
quarkus.http.cors.origins=/.*/
quarkus.http.cors.headers=accept,authorization,content-type,x-requested-with
quarkus.http.cors.exposed-headers=authorization,content-type
quarkus.http.cors.methods=GET,POST,PUT,DELETE,OPTIONS
quarkus.http.cors.access-control-allow-credentials=true
quarkus.http.cors.access-control-max-age=24H

# LLM Configuration for tests
# Use a dummy API key for tests (LLM service won't be actually called in most tests)
quarkus.langchain4j.azure-openai.api-key=test-dummy-key
quarkus.langchain4j.azure-openai.endpoint=https://dummy.openai.azure.com/
quarkus.langchain4j.azure-openai.timeout=30s